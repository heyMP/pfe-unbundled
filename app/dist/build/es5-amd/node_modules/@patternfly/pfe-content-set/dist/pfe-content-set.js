define(["exports","../../pfelement/dist/pfelement.js","../../pfe-accordion/dist/pfe-accordion.js","../../pfe-tabs/dist/pfe-tabs.js"],function(_exports,_pfelement,_pfeAccordion,_pfeTabs){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_pfelement=babelHelpers.interopRequireDefault(_pfelement);_pfeAccordion=babelHelpers.interopRequireDefault(_pfeAccordion);_pfeTabs=babelHelpers.interopRequireDefault(_pfeTabs);function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"===typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"===typeof o.length){if(it)o=it;var i=0,F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:!0};return{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=!0,didErr=!1,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e2){didErr=!0;err=_e2},f:function f(){try{if(!normalCompletion&&null!=it.return)it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"===typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor)n=o.constructor.name;if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=babelHelpers.getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=babelHelpers.getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return babelHelpers.possibleConstructorReturn(this,result)}}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return!0}catch(e){return!1}}// @POLYFILL  NodeList.prototype.forEach()
// https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach
if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=function(callback,thisArg){thisArg=thisArg||window;for(var i=0;i<this.length;i++){callback.call(thisArg,this[i],i,this)}}}// @POLYFILL  Object.prototype.assign()
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Polyfill
if("function"!==typeof Object.assign){// Must be writable: true, enumerable: false, configurable: true
Object.defineProperty(Object,"assign",{value:function assign(target,varArgs){if(null===target||target===void 0){throw new TypeError("Cannot convert undefined or null to object")}for(var to=Object(target),index=1,nextSource;index<arguments.length;index++){nextSource=arguments[index];if(null!==nextSource&&nextSource!==void 0){for(var nextKey in nextSource){// Avoid bugs when hasOwnProperty is shadowed
if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey]}}}}return to},writable:!0,configurable:!0})}/*!
 * PatternFly Elements: PfeContentSet 1.0.0
 * @license
 * Copyright 2020 Red Hat, Inc.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
*/var CONTENT_MUTATION_CONFIG={characterData:!0,childList:!0,subtree:!0},PfeContentSet=/*#__PURE__*/function(_PFElement){babelHelpers.inherits(PfeContentSet,_PFElement);var _super=_createSuper(PfeContentSet);babelHelpers.createClass(PfeContentSet,[{key:"html",// Injected at build-time
get:function get(){return"\n<style>:host{display:block}#lightdom,:host([hidden]){display:none} /*# sourceMappingURL=pfe-content-set.min.css.map */</style>\n<div id=\"lightdom\" hidden>\n  <slot></slot>\n</div>\n<pfe-tabs hidden></pfe-tabs>\n<pfe-accordion hidden></pfe-accordion>"}},{key:"templateUrl",get:function get(){return"pfe-content-set.html"}},{key:"styleUrl",get:function get(){return"pfe-content-set.scss"}},{key:"isTab",get:function get(){var breakpointValue=this.breakpoint?parseInt(this.breakpoint.replace(/\D/g,"")):700;return this.parentNode?this.parentNode.offsetWidth>breakpointValue:window.outerWidth>breakpointValue}},{key:"tab",get:function get(){// Check if the appropriate tag exists already
return this.shadowRoot.querySelector(_pfeTabs.default.tag)}},{key:"accordion",get:function get(){// Check if the appropriate tag exists already
return this.shadowRoot.querySelector(_pfeAccordion.default.tag)}},{key:"displayTemplate",get:function get(){var template=document.createElement("template");// // Set up the template for the sets of content
template.innerHTML=this.isTab?_pfeTabs.default.template:_pfeAccordion.default.template;return template}}],[{key:"version",// Injected at build-time
get:function get(){return"1.0.0"}},{key:"tag",get:function get(){return"pfe-content-set"}},{key:"meta",get:function get(){return{title:"Content set",description:"This element creates a flexible component that renders an accordion or tabset depending on screen size."}}},{key:"pfeType",get:function get(){return _pfelement.default.pfeType.combo}},{key:"properties",get:function get(){// @TODO: Move this logic to pfelement
// This removes observers that live in the dependent components
// and cascades the property to the relevant component if it's not
// an aliased property (just cascade the source of truth instead of both)
var inheritProperties=function inheritProperties(obj,tagName){for(var newObj=Object.assign({},obj),_i=0,_Object$entries=Object.entries(newObj);_i<_Object$entries.length;_i++){var _Object$entries$_i=babelHelpers.slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];// Delete the observer from the property
if(value.observer)delete newObj[key].observer;if(value.cascade)delete newObj[key].cascade;// If alias exists, don't add cascade
if(!value.alias)newObj[key].cascade=tagName}return newObj},tabProps=inheritProperties(_pfeTabs.default.properties,_pfeTabs.default.tag),accordionProps=inheritProperties(_pfeAccordion.default.properties,_pfeAccordion.default.tag),dependentProps=Object.assign(tabProps,accordionProps);// Set up the inheritance for tabs and accordion
// Assign these values to the combo along with it's own properties
return Object.assign(dependentProps,{breakpoint:{title:"Custom breakpoint",type:String,observer:"_updateBreakpoint"},// @TODO: Deprecated in 1.0
align:{type:String,enum:["center"],alias:"tabAlign"},oldAlign:{attr:"pfe-align",alias:"tabAlign"},// @TODO: Deprecated in 1.0
oldBreakpoint:{type:String,alias:"breakpoint",attr:"pfe-breakpoint"},// @TODO: Deprecated in 1.0
pfeId:{type:String,attr:"pfe-id",observer:"_copyToId"}})}},{key:"slots",get:function get(){return{default:{title:"Default",type:"array",namedSlot:!1,items:{$ref:"raw"}}}}}]);function PfeContentSet(){var _this;babelHelpers.classCallCheck(this,PfeContentSet);_this=_super.call(this,PfeContentSet);_this._mutationHandler=_this._mutationHandler.bind(babelHelpers.assertThisInitialized(_this));_this._resizeHandler=_this._resizeHandler.bind(babelHelpers.assertThisInitialized(_this));_this._observer=new MutationObserver(_this._mutationHandler);if(window.ResizeObserver)_this._resizeObserver=new ResizeObserver(_this._resizeHandler);return _this}babelHelpers.createClass(PfeContentSet,[{key:"connectedCallback",value:function connectedCallback(){var _this2=this;babelHelpers.get(babelHelpers.getPrototypeOf(PfeContentSet.prototype),"connectedCallback",this).call(this);if(this.hasLightDOM()){Promise.all([customElements.whenDefined(_pfeTabs.default.tag),customElements.whenDefined(_pfeAccordion.default.tag)]).then(function(){_this2._build()})}this._observer.observe(this,CONTENT_MUTATION_CONFIG);// If the browser supports the resizeObserver and the parentElement exists, set to observe
if(window.ResizeObserver&&this.parentElement)this._resizeObserver.observe(this.parentElement)}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(PfeContentSet.prototype),"disconnectedCallback",this).call(this);this._observer.disconnect();if(window.ResizeObserver)this._resizeObserver.disconnect()}},{key:"_mutationHandler",value:function _mutationHandler(mutationsList){var _this3=this;if(window.ShadyCSS){this._observer.disconnect();// Use the vanilla build tasks in IE11
this._build();setTimeout(function(){_this3._observer.observe(_this3,CONTENT_MUTATION_CONFIG)},0);return}if(mutationsList){var _iterator=_createForOfIteratorHelper(mutationsList),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var mutation=_step.value;switch(mutation.type){case"childList":if(mutation.addedNodes)this._build(mutation.addedNodes);if(mutation.removedNodes)this._removeNodes(mutation.removedNodes);break;case"characterData":if(mutation.target&&mutation.target.parentNode)this._updateNode(mutation.target.parentNode,mutation.target.textContent);break;}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}else{// If no mutation list is provided, rebuild the whole thing
this._build()}}},{key:"_isHeader",value:function _isHeader(el){return el.hasAttribute("".concat(this.tag,"--header"))||el.tagName.match(/H[1-6]/)}},{key:"_isPanel",value:function _isPanel(el){return el.hasAttribute("".concat(this.tag,"--panel"))}},{key:"_toggleVisible",value:function _toggleVisible(){if(this.isTab){if(this.tab)this.tab.removeAttribute("hidden");if(this.accordion)this.accordion.setAttribute("hidden","")}else{if(this.accordion)this.accordion.removeAttribute("hidden");if(this.tab)this.tab.setAttribute("hidden","")}}},{key:"_removeNodes",value:function _removeNodes(list){var _this4=this,host=this.isTab?this.tab:this.accordion;list.forEach(function(item){return _this4._removeNode(item)});// Check if the container is empty
if(!host.hasChildNodes())host.setAttribute("hidden","")}},{key:"_findConnection",value:function _findConnection(node,host){if("#text"!==node.nodeName){// If this node is mapped to one in the shadow DOM
if(node.hasAttribute("maps-to")){var id=node.getAttribute("maps-to");if(null!==id){var connection=host.querySelector("#".concat(id));if(connection){return connection}else{this.warn("no element could be found with #".concat(id))}}}}return null}},{key:"_removeNode",value:function _removeNode(node){var _this5=this;[this.tab,this.accordion].forEach(function(host){var connection=_findConnection(node,host);if(connection)host.removeChild(connection);// Fire a full rebuild if it can't determine the mapped element
else _this5._build()})}},{key:"_updateNode",value:function _updateNode(node,textContent){var _this6=this;[this.tab,this.accordion].forEach(function(host){var connection=_findConnection(node,host);if(connection)connection.textContent=textContent;// Fire a full rebuild if it can't determine the mapped element
else _this6._build()})}},{key:"_buildSets",value:function _buildSets(sets){for(var _this7=this,fragment=document.createDocumentFragment(),_loop=function _loop(i){var header=sets[i],panel=sets[i+1],template=_this7.displayTemplate.content.cloneNode(!0);if(!header)_this7.warn("no element found at position ".concat(i," of the light DOM input."));if(!panel)_this7.warn("no element found at position ".concat(i+1," of the light DOM input."));if(header&&_this7._isHeader(header)&&panel&&_this7._isPanel(panel)){// Capture the line-item from the template
[header,panel].forEach(function(region,idx){var type=0===idx?"header":"panel",piece=template.querySelector("[content-type=\"".concat(type,"\"]")).cloneNode(!0),id=region.id||region.getAttribute("pfe-id")||_this7.randomId,clone=region.cloneNode(!0);// Remove the flag from the clone
clone.removeAttribute("".concat(_this7.tag,"--").concat(type));// Append a clone of the region to the template item
piece.appendChild(clone);// Flag light DOM as upgraded
region.setAttribute("maps-to",id);piece.id=id;// Attach the template item to the fragment
fragment.appendChild(piece)})}},i=0;i<sets.length;i=i+2){_loop(i)}return fragment}},{key:"_build",value:function _build(addedNodes){var _this8=this;// Check if the appropriate tag exists already
[this.tab,this.accordion].forEach(function(host){// If no id is present, give it the id from the wrapper
if(!host.id)host.id=_this8.id||_this8.pfeId||_this8.randomId;var rawSets=addedNodes?addedNodes:_this8.children?_this8.children:null;// Clear out the content of the host if we're using the full child list
if(!addedNodes&&rawSets)host.innerHTML="";// If sets is not null, build them usin gthe template
if(rawSets){var sets=_this8._buildSets(rawSets);if(sets){host.appendChild(sets)}}_this8._toggleVisible()});// Wait until the tags upgrade before setting the selectedIndex value
Promise.all([customElements.whenDefined(_pfeTabs.default.tag),customElements.whenDefined(_pfeAccordion.default.tag)]).then(function(){// pass the selectedIndex property down from pfe-content-set
// to pfe-tabs if there is a selectedIndex value that's not 0
if(_this8.isTab){if(_this8.selectedIndex){_this8.tab.selectedIndex=_this8.selectedIndex}}})}},{key:"_copyToId",value:function _copyToId(){// Don't overwrite an existing ID but backwards support pfe-id
if(!this.id)this.id=this.pfeId}},{key:"_resizeHandler",value:function _resizeHandler(){this._toggleVisible()}},{key:"_updateBreakpoint",value:function _updateBreakpoint(oldVal,newVal){// If the correct rendering element isn't in use yet, build it from scratch
this._toggleVisible()}}]);return PfeContentSet}(_pfelement.default);_pfelement.default.create(PfeContentSet);var _default=PfeContentSet;_exports.default=_default});